<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Algorand Cryptographic Primitive Specification</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Algorand Cryptographic Primitive Specification</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#representation">Representation</a><ul>
<li><a href="#canonical-msgpack">Canonical Msgpack</a></li>
<li><a href="#domain-separation">Domain Separation</a></li>
</ul></li>
<li><a href="#hash-function">Hash Function</a></li>
<li><a href="#digital-signature">Digital Signature</a><ul>
<li><a href="#ephemeral-key-signature">Ephemeral-key Signature</a></li>
</ul></li>
<li><a href="#verifiable-random-function">Verifiable Random Function</a><ul>
<li><a href="#cryptographic-sortition">Cryptographic Sortition</a></li>
</ul></li>
</ul>
</nav>
<h1 id="representation">Representation</h1>
<p>As a preliminary for guaranteeing cryptographic data integrity, Algorand represents all inputs to cryptographic functions (i.e., a cryptographic hash, signature, or verifiable random function) via a canonical and domain-separated representation.</p>
<h2 id="canonical-msgpack">Canonical Msgpack</h2>
<p>Algorand uses a version of <a href="TODO-msgpack">msgpack</a> to produce canonical encodings of data. Algorand’s msgpack encodings are valid msgpack encodings, but the encoding function is deterministic to ensure a canonical representation that can be reproduced to verify signatures. A canonical msgpack encoding in Algorand must follow these rules:</p>
<ol type="1">
<li>Maps must contain keys in lexicographic order;</li>
<li>Maps must omit key-value pairs where the value is a zero-value, unless otherwise specified;</li>
<li>Positive integer values must be encoded as “unsigned” in msgpack, regardless of whether the value space is semantically signed or unsigned;</li>
<li>Integer values must be represented in the shortest possible encoding;</li>
<li>Binary arrays must be represented using the “bin” format family (that is, use the most recent version of msgpack rather than the older msgpack version that had no “bin” family).</li>
</ol>
<h2 id="domain-separation">Domain Separation</h2>
<p>Before an object is input to some cryptographic function, it is prepended with a multi-character domain-separating prefix. The list below specifies each prefix (in quotation marks):</p>
<ul>
<li>For cryptographic primitives:
<ul>
<li>“OT1” and “OT2”: The first and second layers of keys used for <a href="Ephemeral-key%20Signatures">ephemeral signatures</a>.</li>
</ul></li>
<li>In the <a href="https://github.com/algorand/spec/ledger.md">Algorand Ledger</a>:
<ul>
<li>“BH”: A <em>Block Header</em>.</li>
<li>“BR”: A <em>Balance Record</em>.</li>
<li>“GE”: A <em>Genesis</em> configuration.</li>
<li>“PF”: A <em>Payset</em> encoded as a flat list.</li>
<li>“TX”: A <em>Transaction</em>.</li>
</ul></li>
<li>In the <a href="https://github.com/algorand/spec/abft.md">Algorand Byzantine Fault Tolerance protocol</a>:
<ul>
<li>“AS”: An <em>Agreement Selector</em>, which is also a <a href="#verifiable-random-function">VRF</a> input.</li>
<li>“CR”: A <em>Credential</em>.</li>
<li>“SD”: A <em>Seed</em>.</li>
<li>“PL”: A <em>Payload</em>.</li>
<li>“PS”: A <em>Proposer Seed</em>.</li>
<li>“VO”: A <em>Vote</em>.</li>
</ul></li>
<li>In other places:
<ul>
<li>“MX”: An arbitrary message used to prove ownership of a cryptographic secret.</li>
<li>“NPR”: A message which proves a peer’s stake in an Algorand networking implementation.</li>
<li>“TE”: An arbitrary message reserved for testing purposes.</li>
<li>“Program”: A TEAL bytecode program.</li>
<li>In Algorand auctions:
<ul>
<li>“aB”: A <em>Bid</em>.</li>
<li>“aD”: A <em>Deposit</em>.</li>
<li>“aO”: An <em>Outcome</em>.</li>
<li>“aP”: Auction parameters.</li>
<li>“aS”: A <em>Settlement</em>.</li>
</ul></li>
</ul></li>
</ul>
<h1 id="hash-function">Hash Function</h1>
<p>Algorand uses the <a href="TODO-sha">SHA-512/256 algorithm</a> as its primary cryptographic hash function.</p>
<p>Algorand uses this hash function to (1) commit to data for signing and for the Byzantine Fault Tolerance protocol, and (2) rerandomize its random seed.</p>
<h1 id="digital-signature">Digital Signature</h1>
<p>Algorand uses the <a href="TODO-ed25519">ed25519</a> digital signature scheme to sign data.</p>
<h2 id="ephemeral-key-signature">Ephemeral-key Signature</h2>
<h1 id="verifiable-random-function">Verifiable Random Function</h1>
<h2 id="cryptographic-sortition">Cryptographic Sortition</h2>
</body>
</html>
